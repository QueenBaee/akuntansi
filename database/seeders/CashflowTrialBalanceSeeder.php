<?php

namespace Database\Seeders;

use Illuminate\Database\Seeder;
use Illuminate\Support\Facades\DB;

class CashflowTrialBalanceSeeder extends Seeder
{
    public function run()
    {
        // Mapping: cashflow.kode => trial_balance.kode
        $mapping = [

            // =========================
            // PEMASUKAN R
            // =========================
            'R1-01' => 'A12-01',
            'R1-02' => 'R11-02',
            'R1-03' => 'A12-01',

            'R2-01' => 'R21-01',
            'R2-02' => 'R21-01',
            'R2-98' => 'R21-98',
            'R2-99' => 'R21-99',

            // =========================
            // PENGELUARAN PRODUKSI E1
            // =========================
            'E1-01' => 'E11-01',
            'E1-02' => 'E11-01',
            'E1-03' => 'E11-01',
            'E1-04' => 'E11-01',
            'E1-05' => 'E11-01',
            'E1-06' => 'E11-01',
            'E1-07' => 'E11-01',
            'E1-08' => 'E11-01',
            'E1-09' => 'E11-01',

            'E1-10' => 'E11-02',
            'E1-11' => 'E11-02',
            'E1-12' => 'E11-02',
            'E1-13' => 'E11-02',
            'E1-14' => 'E11-02',

            'E1-15' => 'E11-03',
            'E1-16' => 'E11-03',
            'E1-17' => 'E11-03',

            'E1-18' => 'E11-04',
            'E1-19' => 'E11-04',
            'E1-20' => 'E11-04',

            'E1-21' => 'E11-05',

            'E1-22' => 'E11-06',
            'E1-23' => 'E11-06',

            // =========================
            // UMUM & ADMINISTRASI E3
            // =========================

            'E3-01' => 'E22-01',
            'E3-02' => 'E22-01',
            'E3-03' => 'E22-01',
            'E3-04' => 'E22-01',
            'E3-05' => 'E22-01',
            'E3-06' => 'E22-01',
            'E3-07' => 'E22-01',
            'E3-08' => 'E22-01',
            'E3-09' => 'E22-01',

            'E3-10' => 'E22-02',
            'E3-11' => 'E22-02',
            'E3-12' => 'E22-02',
            'E3-13' => 'E22-02',

            'E3-14' => 'E22-03',
            'E3-15' => 'E22-03',
            'E3-16' => 'E22-03',

            'E3-17' => 'E22-04',
            'E3-18' => 'E22-04',
            'E3-19' => 'E22-04',
            'E3-20' => 'E22-04',

            'E3-21' => 'E22-05',
            'E3-22' => 'E22-05',
            'E3-23' => 'E22-05',
            'E3-25' => 'E22-05',
            'E3-26' => 'E22-05',
            'E3-27' => 'E22-05',
            'E3-28' => 'E22-05',
            'E3-29' => 'E22-05',
            'E3-30' => 'E22-05',
            'E3-52' => 'E22-05',

            'E3-24' => 'A13-99',

            'E3-31' => 'E22-07',
            'E3-32' => 'E22-07',
            'E3-33' => 'E22-07',
            'E3-34' => 'E22-07',
            'E3-35' => 'E22-07',

            'E3-36' => 'E22-08',
            'E3-37' => 'E22-08',
            'E3-38' => 'E22-08',
            'E3-39' => 'E22-08',
            'E3-40' => 'E22-08',
            'E3-41' => 'E22-08',
            'E3-42' => 'E22-08',
            'E3-43' => 'E22-08',

            'E3-44' => 'E22-09',
            'E3-45' => 'E22-09',

            'E3-46' => 'E22-10',
            'E3-47' => 'E22-10',

            'E3-48' => 'E22-89',
            'E3-49' => 'E22-89',
            'E3-50' => 'E22-89',
            'E3-51' => 'E22-89',

            'E3-53' => null, // tidak ada mapping
            'E3-99' => 'E22-89',

            // =========================
            // PENGELUARAN LAIN-LAIN
            // =========================

            'E4-01' => 'E31-01',
            'E4-02' => null,

            // =========================
            // F: INVESTASI
            // =========================

            'F1-01' => 'A23-99',
            'F1-02' => 'A23-99',
            'F1-03' => 'A23-99',
            'F1-04' => 'A23-99',
            'F1-05' => 'A23-99',

            'F1-06' => 'A14-99',
            'F1-07' => 'A14-99',
            'F1-08' => null,

            // =========================
            // F2: PENDANAAN
            // =========================

            'F2-01' => 'A13-01',
            'F2-02' => 'A13-02',
            'F2-03' => 'A13-03',
            'F2-04' => 'A13-02',
            'F2-05' => null,

            'F2-90' => 'A13-99',
            'F2-96' => 'C21-02',
            'F2-97' => 'C11-01',
            'F2-98' => 'C11-02',
            'F2-99' => 'C11-03',

            'PB'     => 'PB',
        ];

        foreach ($mapping as $cashflowKode => $tbKode) {

            $cashflow = DB::table('cashflows')->where('kode', $cashflowKode)->first();
            if (!$cashflow) continue;

            $tb = $tbKode
                ? DB::table('trial_balances')->where('kode', $tbKode)->first()
                : null;

            DB::table('cashflows')->where('id', $cashflow->id)->update([
                'trial_balance_id' => $tb?->id
            ]);
        }
    }
}
